<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¾™ä¹‹å›½åº¦ï¼šæäºšæ›¼ç‘Ÿ - 5eè§’è‰²åˆ›å»ºåŠ©æ‰‹</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=MedievalSharp&family=Noto+Serif+SC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* ä¿æŒåŸæœ‰æ ·å¼ä¸å˜ */
        :root {
            --color-primary: #8B0000;
            --color-secondary: #D4AF37;
            --color-dark: #0a0a0a;
            --color-dark-gray: #1a1a1a;
            --color-gray: #2a2a2a;
            --color-light: #e8e8e8;
            --color-accent: #006400;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Noto Serif SC', serif;
            background-color: var(--color-dark);
            color: var(--color-light);
            line-height: 1.6;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
            min-height: 100vh;
            background-image: 
                linear-gradient(rgba(10, 10, 10, 0.9), rgba(10, 10, 10, 0.9)),
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 10px,
                    rgba(212, 175, 55, 0.05) 10px,
                    rgba(212, 175, 55, 0.05) 20px
                );
        }
        header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--color-secondary);
            position: relative;
        }
        header::after {
            content: "âš”ï¸";
            position: absolute;
            bottom: -15px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--color-dark);
            padding: 0 10px;
            font-size: 1.5em;
        }
        h1, h2, h3 {
            font-family: 'Cinzel', serif;
            color: var(--color-secondary);
            text-shadow: 0 0 5px rgba(212, 175, 55, 0.5);
        }
        h1 { font-size: 2.8em; margin-bottom: 10px; letter-spacing: 2px; }
        h2 { font-size: 2em; margin: 25px 0 15px; border-left: 4px solid var(--color-primary); padding-left: 10px; }
        h3 { font-size: 1.5em; margin: 20px 0 10px; color: var(--color-light); }
        .intro {
            font-family: 'MedievalSharp', cursive;
            font-size: 1.2em;
            background-color: rgba(26, 26, 26, 0.8);
            border: 1px solid var(--color-secondary);
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
            line-height: 1.8;
            text-align: justify;
            box-shadow: 0 0 15px rgba(139, 0, 0, 0.3);
        }
        .wizard-step {
            display: none;
            background-color: var(--color-dark-gray);
            border: 1px solid var(--color-gray);
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }
        .wizard-step.active { display: block; }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; color: var(--color-secondary); }
        select, input[type="text"], input[type="number"] {
            width: 100%; padding: 12px; background-color: var(--color-gray); border: 1px solid #444; border-radius: 4px; color: var(--color-light); font-size: 1em; font-family: 'Noto Serif SC', serif;
        }
        select:focus, input:focus { outline: none; border-color: var(--color-secondary); box-shadow: 0 0 5px var(--color-secondary); }
        .radio-group, .checkbox-group { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 12px; margin-top: 10px; }
        .option-card {
            background: var(--color-gray); border: 2px solid transparent; border-radius: 6px; padding: 15px; cursor: pointer; transition: all 0.3s ease;
        }
        .option-card:hover { border-color: var(--color-secondary); background-color: #333; }
        .option-card.selected { border-color: var(--color-primary); background-color: rgba(139, 0, 0, 0.2); box-shadow: inset 0 0 10px rgba(139, 0, 0, 0.5); }
        .option-card input { display: none; }
        .option-card label { cursor: pointer; margin: 0; font-weight: normal; color: var(--color-light); }
        .option-card .desc { font-size: 0.9em; color: #aaa; margin-top: 5px; }
        .button-container { display: flex; justify-content: space-between; margin-top: 30px; padding-top: 20px; border-top: 1px solid #444; }
        button { padding: 12px 30px; font-family: 'Cinzel', serif; font-weight: bold; font-size: 1em; border: none; border-radius: 4px; cursor: pointer; transition: all 0.3s ease; }
        .btn-prev { background-color: #444; color: var(--color-light); }
        .btn-next, .btn-generate, .btn-select { background-color: var(--color-primary); color: var(--color-light); }
        .btn-prev:hover { background-color: #555; }
        .btn-next:hover, .btn-generate:hover, .btn-select:hover { background-color: #a00; }
        .btn:disabled { background-color: #333; color: #666; cursor: not-allowed; }
        .output-card {
            background-color: var(--color-dark-gray); border: 2px solid var(--color-secondary); border-radius: 8px; padding: 25px; margin: 20px 0; white-space: pre-wrap; font-family: 'Courier New', monospace; font-size: 0.95em; line-height: 1.5; max-height: 500px; overflow-y: auto;
        }
        .hidden-info { color: #666; font-style: italic; font-size: 0.9em; margin-top: 5px; }
        .tip-box { background-color: rgba(0, 100, 0, 0.2); border: 1px solid var(--color-accent); border-radius: 6px; padding: 20px; margin: 25px 0; }
        .tip-box h4 { color: #90ee90; margin-bottom: 10px; }
        .final-prompt { background-color: rgba(212, 175, 55, 0.1); border: 1px dashed var(--color-secondary); padding: 25px; margin-top: 30px; text-align: center; }
        footer { text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #444; color: #888; font-size: 0.9em; }
        footer a { color: var(--color-secondary); text-decoration: none; }
        footer a:hover { text-decoration: underline; }
        .step-indicator { display: flex; justify-content: center; margin-bottom: 20px; flex-wrap: wrap; }
        .step-dot { width: 12px; height: 12px; background-color: #444; border-radius: 50%; margin: 0 8px 8px; transition: background-color 0.3s; }
        .step-dot.active { background-color: var(--color-primary); }
        .step-dot.completed { background-color: var(--color-secondary); }
    </style>
</head>
<body>
    <header>
        <h1>ğŸ‰ é¾™ä¹‹å›½åº¦ï¼šæäºšæ›¼ç‘Ÿ ğŸ‰</h1>
        <p>ç¬¬äº”ç‰ˆé¾™ä¸åœ°ä¸‹åŸè§’è‰²åˆ›å»ºè¾…åŠ©ç³»ç»Ÿ</p>
    </header>

    <section class="intro">
        â€œæ—…è€…å•Šï¼Œæ¬¢è¿æ¥åˆ°é¾™çš„å›½åº¦ã€‚è¯·è†å¬éšé£ä¼ æ¥çš„å·è§’å£°â€¦â€¦é‚£æ¥è‡ªä¸œæ–¹çš„è®¯æ¯ã€‚<br><br>
        èµ·åˆï¼Œå¯¹äºå‰‘æ¹¾çš„é¢†ä¸»ä»¬è€Œè¨€ï¼Œä¸œè¾¹é‚£åœºUntherä¸Tymantherçš„æˆ˜äº‰ï¼Œä¸è¿‡æ˜¯èŒ¶ä½™é¥­åç”¨æ¥æ‰“å‘æ—¶é—´çš„è°ˆèµ„ã€‚å¤è€çš„ç¥ç‹æƒ³è¦ç¢¾ç¢é‚£ç¾¤æµäº¡çš„é¾™è£”â€”â€”è¿™æ¯«æ— æ‚¬å¿µï¼Œå°±åƒå·¨çŸ³æ³¨å®šå‹ç¢é¸Ÿè›‹ã€‚æˆ‘ä»¬æ›¾ä»¥ä¸ºï¼Œé‚£ä¸ªåå­—å°†æ°¸è¿œåŸ‹è‘¬åœ¨å†å²çš„å°˜åŸƒé‡Œã€‚<br><br>
        ç›´åˆ°é‚£ä¸€å¤©ï¼Œå¤©ç©ºè¢«äº”è‰²çš„é›·éœ†æ’•è£‚ã€‚<br><br>
        ä¼ é—»ä¸­ï¼Œä¸€å¤´å·¨é¾™é®è”½äº†å¤ªé˜³ï¼Œç¥ç‹çš„å†›é˜Ÿåœ¨é¾™æ¯ä¸­åŒ–ä¸ºç°çƒ¬ã€‚å¥‡è¿¹â€”â€”äº¦æˆ–æ˜¯ç¾å„â€”â€”å°±è¿™æ ·é™ä¸´äº†ã€‚â€˜æäºšæ›¼ç‘Ÿâ€™ï¼ˆTiamantherï¼‰çš„æ——å¸œåœ¨åºŸå¢Ÿä¸Šç«‹èµ·ã€‚ä½†é‚£æ—¶ï¼Œè°åˆçœŸçš„åœ¨æ„å‘¢ï¼Ÿæ¯•ç«Ÿï¼Œé‚£åªæ˜¯ä¸€ä¸ªåœ¨äºŒåå¹´æˆ˜ç«ä¸­æµå¹²äº†é²œè¡€çš„ç©ºå£³ï¼Œä¸€ä¸ªç”±ç ´ç¢çš„ç –çŸ³å’Œå°¸éª¨å †ç Œçš„ç©·ä¹¡åƒ»å£¤ã€‚æ³•å¸ˆä»¬åœ¨é«˜å¡”ä¸­æ–­è¨€ï¼Œå®ƒéœ€è¦ä¸€ç™¾å¹´æ‰èƒ½å–˜è¿‡æ°”æ¥ã€‚<br><br>
        æˆ‘ä»¬éƒ½é”™äº†ã€‚<br><br>
        å½“æˆ‘ä»¬åœ¨è¿™ä¸ªä¸–ç•Œçš„ä¸€è§’é†‰ç”Ÿæ¢¦æ­»æ—¶ï¼Œé‚£å¤´ç›˜è¸åœ¨åºŸå¢Ÿä¸Šçš„å·¨é¾™å¹¶æ²¡æœ‰èˆ”èˆä¼¤å£ï¼Œè€Œæ˜¯åœ¨ç°çƒ¬ä¸­ç£¨ç ºçˆªç‰™ã€‚æ²¡æœ‰äººçœ‹æ¸…ä»–æ˜¯å¦‚ä½•åšåˆ°çš„â€”â€”åªçŸ¥é“å½“ç©†å°”éœå§†ï¼ˆMurghomï¼‰åœ¨æ²‰é»˜ä¸­è¢«ä¸€å£åä¸‹æ—¶ï¼Œå¤§åœ°å¼€å§‹éœ‡é¢¤ã€‚<br><br>
        å¦‚ä»Šï¼Œé‚£åŒè´ªå©ªçš„ç«–ç³å·²ç»è¶Šè¿‡è¾¹å¢ƒï¼Œæ­»æ­»ç›¯ä½äº†ç©†å°”éœå…°å¾·çš„é»„é‡‘ç¥æ®¿ã€‚ä¸å†æ˜¯æŒ£æ‰æ±‚å­˜ï¼Œè€Œæ˜¯ä¸»åŠ¨æ•é£Ÿã€‚<br><br>
        ä½ å¬åˆ°äº†å—ï¼Ÿé‚£ä¸æ˜¯é›·å£°ï¼Œé‚£æ˜¯ä¸œè´¹ä¼¦ç»Ÿä¸€æˆ˜äº‰çš„æˆ˜é¼“ï¼Œæ˜¯æˆåƒä¸Šä¸‡èº«æŠ«é‡ç”²çš„å†›å›¢è¸è¿‡å¤§åœ°çš„è½°é¸£ã€‚å·¨é¾™æ¥äº†ï¼Œè€Œè¿™ä¸€æ¬¡ï¼Œä»–æƒ³è¦åä¸‹çš„ä¸ä»…ä»…æ˜¯åœŸåœ°ã€‚<br><br>
        ç°åœ¨ï¼Œåœ¨è¿™ä¸ªé£æš´æ±‡èšçš„å‰å¤œï¼Œåœ¨è¿™ç‰‡å³å°†è¢«æˆ˜ç«ç‚¹ç‡ƒçš„åœŸåœ°ä¸Šâ€¦â€¦<br><br>
        <strong>è¯·å‘Šè¯‰æˆ‘ï¼Œä½ åŸæœ¬æ˜¯è°ï¼Ÿä»¥åŠï¼Œä½ ä¸ºä½•è€Œæˆ˜ï¼Ÿâ€</strong>
    </section>

    <div class="step-indicator">
        <div class="step-dot" id="step1-dot"></div>
        <div class="step-dot" id="step2-dot"></div>
        <div class="step-dot" id="step3-dot"></div>
        <div class="step-dot" id="step4-dot"></div>
        <div class="step-dot" id="step5-dot"></div>
        <div class="step-dot" id="step6-dot"></div>
        <div class="step-dot" id="step7-dot"></div>
    </div>

    <!-- æ­¥éª¤1ï¼šç§æ—ä¸èŒä¸š -->
    <div id="step1" class="wizard-step active">
        <h2>ç¬¬ä¸€æ­¥ï¼šæ ¹åŸº - ç§æ—ä¸èŒä¸š</h2>
        <p>é€‰æ‹©ä½ çš„è¡€è„‰ä¸é“è·¯ã€‚åœ¨æäºšæ›¼ç‘Ÿï¼ŒåŠ›é‡å®šä¹‰ä¸€åˆ‡ã€‚</p>
        <div class="form-group">
            <label for="race">ç§æ—</label>
            <select id="race">
                <option value="">-- é€‰æ‹©ä½ çš„ç§æ— --</option>
                <option value="human">äººç±»</option>
                <option value="dragonborn">é¾™è£”</option>
                <option value="kobold">ç‹—å¤´äºº</option>
                <option value="half-orc">åŠå…½äºº</option>
                <option value="lizardfolk">èœ¥èœ´äºº</option>
                <option value="elf">ç²¾çµ</option>
                <option value="dwarf">çŸ®äºº</option>
                <option value="other">å…¶ä»–</option>
            </select>
            <div class="hidden-info">æç¤ºï¼šç‹—å¤´äººä¸äººç±»å…³ç³»è‰¯å¥½ï¼Œæ˜¯å¸å›½å†œä¸šçš„åŸºçŸ³ã€‚</div>
        </div>
        <div class="form-group">
            <label for="class">èŒä¸š</label>
            <select id="class">
                <option value="">-- é€‰æ‹©ä½ çš„èŒä¸š --</option>
                <option value="fighter">æˆ˜å£«</option>
                <option value="paladin">åœ£æ­¦å£«</option>
                <option value="ranger">æ¸¸ä¾ </option>
                <option value="rogue">æ¸¸è¡è€…</option>
                <option value="wizard">æ³•å¸ˆ</option>
                <option value="cleric">ç‰§å¸ˆ</option>
                <option value="druid">å¾·é²ä¼Š</option>
                <option value="bard">åŸæ¸¸è¯—äºº</option>
                <option value="barbarian">é‡è›®äºº</option>
                <option value="monk">æ­¦åƒ§</option>
                <option value="sorcerer">æœ¯å£«</option>
                <option value="warlock">é‚ªæœ¯å¸ˆ</option>
            </select>
        </div>
        <div class="button-container">
            <button disabled class="btn-prev">ä¸Šä¸€æ­¥</button>
            <button class="btn-next" onclick="nextStep(2)">ä¸‹ä¸€æ­¥</button>
        </div>
    </div>

    <!-- æ­¥éª¤2ï¼šèƒŒæ™¯ä¸å‡ºèº« -->
    <div id="step2" class="wizard-step">
        <h2>ç¬¬äºŒæ­¥ï¼šè¡€è„‰ä¸èµ·ç‚¹</h2>
        <p>ä½ çš„å‡ºèº«å†³å®šäº†ä½ çš„è§†é‡ï¼Œä½†æ— æ³•å†³å®šä½ çš„ç»ˆç‚¹ã€‚</p>
        <div class="form-group">
            <label>ä½ çš„ä¿¡ä»°ï¼Ÿ</label>
            <select id="faith">
                <option value="">-- é€‰æ‹©ä¿¡ä»° (å¯é€‰) --</option>
                <option value="tiamat">æäºšç›ç‰¹ (å¸å›½å›½æ•™)</option>
                <option value="bahamut">å·´å“ˆå§†ç‰¹</option>
                <option value="human">äººç±»ç¥ç³»</option>
                <option value="orc">å…½äººç¥ç³»</option>
                <option value="Devan">çŸ®äººç¥ç³»</option>
                <option value="Elf">ç²¾çµç¥ç³»</option>
                <option value="mulhorand">Mulhorandå¤šç¥æ•™</option>
                <option value="other">æ— </option>
            </select>
            <div class="hidden-info">æç¤ºï¼šä¿¡ä»°æäºšç›ç‰¹å¯åœ¨å¸å›½å¢ƒå†…è·å¾—5%çš„ç¨æ”¶å‡å…ï¼Œå·´å“ˆå§†ç‰¹æœ‰0.01%ç¨æ”¶å‡å…</div>
        </div>
        <div class="form-group">
            <label>ä½ çš„çˆ¶æ¯æ˜¯å“ªå›½äººï¼Ÿ</label>
            <div class="radio-group">
                <div class="option-card" onclick="selectOption(this, 'nationality')">
                    <input type="radio" id="nat-tia" name="nationality" value="tiamanther">
                    <label for="nat-tia">Tiamantheräºº(æ™®é€šæ¨¡å¼)</label>
                    <div class="desc">é¾™çš„å­æ°‘ï¼Œç»ˆç„‰åœ£å¸Aurelius Valeriusçš„åŒç¿¼åº‡æŠ¤ç€å¸å›½ã€‚</div>
                </div>
                <div class="option-card" onclick="selectOption(this, 'nationality')">
                    <input type="radio" id="nat-mul" name="nationality" value="mulhorand">
                    <label for="nat-mul">Mulhorandäººï¼ˆæéš¾æ¨¡å¼ï¼‰</label>
                    <div class="desc">ç¥ç‹çš„å­æ°‘ï¼Œå¤ªé˜³ç¥Horus-Reçš„å…‰è¾‰ç…§è€€ç€ç‹å›½ã€‚</div>
                </div>
                <div class="option-card" onclick="selectOption(this, 'nationality')">
                    <input type="radio" id="nat-faerun" name="nationality" value="faerun">
                    <label for="nat-faerun">è´¹ä¼¦å…¶ä»–å›½åº¦(å›°éš¾æ¨¡å¼)</label>
                    <div class="desc">æ¥è‡ªå‰‘æ¹¾ã€æœˆæµ·æˆ–æ›´é¥è¿œä¹‹åœ°ã€‚</div>
                </div>
                <div class="option-card" style="opacity: 0.5; cursor: not-allowed; border-style: dashed; background: #2a2a2a;">
                    <label style="color: #666;">[æ•°æ®åˆ é™¤] (ç®€å•æ¨¡å¼)</label>
                    <div class="desc" style="color: #555;">åˆ«æ‰¾äº†ï¼Œæ²¡æœ‰ç®€å•æ¨¡å¼ã€‚åœ¨è¿™ç§ä¹±ä¸–ï¼Œè°ä¹Ÿåˆ«æƒ³è¿‡å¾—è½»æ¾ã€‚</div>
                </div>
            </div>
        </div>
        <div class="form-group">
            <label>ä½ çˆ¶æ¯çš„ç¤¾ä¼šåœ°ä½æ˜¯ï¼Ÿ</label>
            <div class="radio-group">
                <div class="option-card" onclick="selectOption(this, 'parentStatus')">
                    <input type="radio" id="ps-poor" name="parentStatus" value="poor">
                    <label for="ps-poor">è´«æ°‘</label>
                    <div class="desc">æ¯æ—¥ä¸ºäº†ç”Ÿè®¡å‘æ„</div>
                </div>
                <div class="option-card" onclick="selectOption(this, 'parentStatus')">
                    <input type="radio" id="ps-common" name="parentStatus" value="common">
                    <label for="ps-common">å¹³æ°‘</label>
                    <div class="desc">è‡ªè€•å†œã€å·¥åŒ æˆ–å°å•†äººã€‚</div>
                </div>
                <div class="option-card" onclick="selectOption(this, 'parentStatus')">
                    <input type="radio" id="ps-burgher" name="parentStatus" value="burgher">
                    <label for="ps-burgher">å¸‚æ°‘</label>
                    <div class="desc">åŸé•‡ä¸­çš„è‡ªç”±æ°‘ï¼Œæœ‰ä¸€å®šèµ„äº§ã€‚</div>
                </div>
                <div class="option-card" onclick="selectOption(this, 'parentStatus')">
                    <input type="radio" id="ps-noble" name="parentStatus" value="noble">
                    <label for="ps-noble">å°è´µæ—</label>
                    <div class="desc">æ‹¥æœ‰å°å—å°åœ°ä¸å†›äº‹ä¹‰åŠ¡ã€‚</div>
                </div>
            </div>
         </div>
        <div class="button-container">
            <button class="btn-prev" onclick="prevStep(1)">ä¸Šä¸€æ­¥</button>
            <button class="btn-next" onclick="nextStep(3)">ä¸‹ä¸€æ­¥</button>
        </div>
    </div>

    <!-- æ­¥éª¤3ï¼šæˆå¹´ä¸ç¤¾ä¼šåœ°ä½ -->
    <div id="step3" class="wizard-step">
        <h2>ç¬¬ä¸‰æ­¥ï¼šæˆå¹´çš„é“è·¯</h2>
        <div class="form-group">
            <label>æˆå¹´åï¼Œä½ ä¸è‡ªå·±çš„çˆ¶æ¯å‘Šåˆ«ï¼Œä½ çš„ç¤¾ä¼šåœ°ä½å˜æˆäº†...</label>
            <div class="radio-group">
                <div class="option-card" onclick="selectOption(this, 'adultStatus')">
                    <input type="radio" id="poor" name="adultStatus" value="Poor">
                    <label for="poor">è´«æ°‘</label>
                    <div class="desc">æ— è®ºæ˜¯å‡ºç”Ÿå¤ªå·®ï¼Œè¿æ°”ä¸ä½³ï¼Œè¿˜æ˜¯ç”±äºæŸäº›äººä¸ºå› ç´ ï¼Œæœ€ç»ˆä½ æˆä¸ºäº†ç¤¾ä¼šçš„åº•å±‚</div>
                </div>
                <div class="option-card" onclick="selectOption(this, 'adultStatus')">
                    <input type="radio" id="common" name="adultStatus" value="Common">
                    <label for="common">å¹³æ°‘</label>
                    <div class="desc">ä½ ä¾é è‡ªå·±çš„åŒæ‰‹è·å–é£Ÿç‰©ä¸æŠ¥é…¬ï¼Œç”Ÿæ´»å¹¶ä¸è½»æ¾ï¼Œä½†è‡³å°‘ä½ åœ¨è¿™æ®‹é…·çš„ä¸–ç•Œä¸­æ‰¾åˆ°äº†æ´»ä¸‹å»çš„æ–¹æ³•</div>
                </div>
                <div class="option-card" onclick="selectOption(this, 'adultStatus')">
                    <input type="radio" id="burgher" name="adultStatus" value="Burgher">
                    <label for="burgher">å¸‚æ°‘</label>
                    <div class="desc">é€šè¿‡å‹¤åŠ³ï¼Œæ™ºæ…§ä»¥åŠè¿æ°”ï¼Œä½ çš„ç”Ÿæ´»è™½ä¸æ˜¯å¤§å¯Œå¤§è´µï¼Œä½†ä¹Ÿå·²ç„¶å°åº·ï¼Œæˆä¸ºäº†ç»å¤§å¤šæ•°äººç¾¡æ…•çš„å¯¹è±¡</div>
                </div>
                <div class="option-card" onclick="selectOption(this, 'adultStatus')">
                    <input type="radio" id="Noble" name="adultStatus" value="Noble">
                    <label for="Nobel">å°è´µæ—</label>
                    <div class="desc">å¯èƒ½æ˜¯ç»§æ‰¿è‡ªçˆ¶æ¯ï¼Œä¹Ÿå¯èƒ½æ˜¯é€šè¿‡è‡ªèº«å¼ºå¤§çš„æ­¦åŠ›ï¼Œå‡ºä¼—çš„æ™ºæ…§ä»¥åŠä¸è²çš„è¿æ°”ï¼Œæ€»ä¹‹ä½ æˆä¸ºäº†ä¸€åè´µæ—ï¼Œæ‹¿åˆ°äº†è¿›å…¥è¿™æ–—å…½åœºçš„é—¨ç¥¨</div>
                </div>
            </div>
        </div>
        <div class="tip-box">
            <h4>ğŸ“œ ç³»ç»Ÿæç¤º</h4>
            <p>æ­¤æ­¥éª¤ä¿¡æ¯ä»…ç”¨äºå†…éƒ¨èƒŒæ™¯ç”Ÿæˆã€‚ä½ çš„é€‰æ‹©å°†å½±å“è§’è‰²èƒŒæ™¯çš„åˆç†æ€§ã€‚åœ¨æäºšæ›¼ç‘Ÿï¼Œæ™®é€šäººå†æœ‰é’±ä¹Ÿæ— æ³•æˆä¸ºè´µæ—ï¼Œå”¯æœ‰é€šè¿‡æ­¦åŠ›ä¸åŠŸç»©ï¼ˆæˆä¸ºProï¼‰æ‰èƒ½è·å¾—å†Œå°ã€‚</p>
        </div>
        <div class="button-container">
            <button class="btn-prev" onclick="prevStep(2)">ä¸Šä¸€æ­¥</button>
            <button class="btn-next" onclick="nextStep(4)">ä¸‹ä¸€æ­¥</button>
        </div>
    </div>

    <!-- æ­¥éª¤4ï¼šé˜µè¥ -->
    <div id="step4" class="wizard-step">
        <h2>ç¬¬å››æ­¥ï¼šå†…å¿ƒçš„ç½—ç›˜</h2>
        <p>ç§©åºã€æ··ä¹±ã€å–„è‰¯ã€é‚ªæ¶â€¦â€¦ä½ éµå¾ªä½•ç§ä¿¡æ¡ï¼Ÿ</p>
        <div class="form-group">
            <label>ä½ å¯¹è§„åˆ™çš„æ€åº¦æ˜¯ï¼Ÿ</label>
            <div class="radio-group">
                <div class="option-card" onclick="selectOption(this, 'lawAxis')">
                    <input type="radio" id="law-lawful" name="lawAxis" value="lawful">
                    <label for="law-lawful">å®ˆåº</label>
                    <div class="desc">è®¤åŒæ³•å¾‹ä¸ç§©åºèƒ½è§£å†³é—®é¢˜ã€‚</div>
                </div>
                <div class="option-card" onclick="selectOption(this, 'lawAxis')">
                    <input type="radio" id="law-neutral" name="lawAxis" value="neutral">
                    <label for="law-neutral">ä¸­ç«‹</label>
                    <div class="desc">è§„åˆ™æ˜¯æ­»çš„ï¼Œäººæ˜¯æ´»çš„ï¼Œè§†æƒ…å†µè€Œå®šã€‚</div>
                </div>
                <div class="option-card" onclick="selectOption(this, 'lawAxis')">
                    <input type="radio" id="law-chaotic" name="lawAxis" value="chaotic">
                    <label for="law-chaotic">æ··ä¹±</label>
                    <div class="desc">è§„åˆ™æ˜¯äººå®šçš„ï¼Œæ‰€ä»¥é˜»ç¢è€…çš†å¯æ‰“ç ´ã€‚</div>
                </div>
            </div>
        </div>
        <div class="form-group">
            <label>ä½ å¯¹ä»–äººçš„æ€åº¦æ˜¯ï¼Ÿ</label>
            <div class="radio-group">
                <div class="option-card" onclick="selectOption(this, 'goodAxis')">
                    <input type="radio" id="good-good" name="goodAxis" value="good">
                    <label for="good-good">å–„è‰¯</label>
                    <div class="desc">å€¾å‘äºæ— æ¡ä»¶åœ°åˆ©ä»–ï¼Œå¸®åŠ©ä»–äººèƒ½è®©ä½ ç²¾ç¥æ„‰æ‚¦ï¼Œå“ªæ€•åˆ«äººä¸»åŠ¨è¿›è¡Œå›æŠ¥ï¼Œä½ ä¹Ÿä¼šæ‹’ç»ã€‚</div>
                </div>
                <div class="option-card" onclick="selectOption(this, 'goodAxis')">
                    <input type="radio" id="good-neutral" name="goodAxis" value="neutral">
                    <label for="good-neutral">ä¸­ç«‹</label>
                    <div class="desc">æœ‰ä½™åŠ›æ—¶ä¼šå¸®åŠ©ä»–äººï¼Œå°½ç®¡ä¸æœŸå¾…å›æŠ¥ï¼Œä½†æ€»å½’æœ‰çš„è¯ä¼šæ›´å¥½ã€‚</div>
                </div>
                <div class="option-card" onclick="selectOption(this, 'goodAxis')">
                    <input type="radio" id="good-evil" name="goodAxis" value="evil">
                    <label for="good-evil">é‚ªæ¶</label>
                    <div class="desc">åˆ©å·±ä¸»ä¹‰ï¼Œä»–äººçš„åˆ©ç›Šä¸æˆ‘ä½•å…³ã€‚</div>
                </div>
            </div>
        </div>
        <div class="button-container">
            <button class="btn-prev" onclick="prevStep(3)">ä¸Šä¸€æ­¥</button>
            <button class="btn-next" onclick="generateBackgroundOptions()">ç”ŸæˆèƒŒæ™¯</button>
        </div>
    </div>

    <!-- æ­¥éª¤5ï¼šèƒŒæ™¯é€‰æ‹© -->
    <div id="step5" class="wizard-step">
        <h2>å‡ºäºä»€ä¹ˆåŸå› ï¼Œä½ æ¥åˆ°äº†è¿™é‡Œï¼Ÿ</h2>
        <p>åŸºäºä½ çš„é€‰æ‹©ï¼Œç³»ç»Ÿç”Ÿæˆäº†ä¸‰ä¸ªå¯èƒ½çš„è¿‡å»ã€‚è¯·é€‰æ‹©ä¸€ä¸ªä½œä¸ºä½ çš„è§’è‰²èƒŒæ™¯ã€‚</p>
        <div id="background-options-container">
            <!-- èƒŒæ™¯é€‰é¡¹å°†ç”±JSåŠ¨æ€ç”Ÿæˆ -->
        </div>
        <div class="button-container">
            <button class="btn-prev" onclick="prevStep(4)">ä¸Šä¸€æ­¥</button>
            <button id="btn-choose-bg" class="btn-select" onclick="generateCharacterSheet()" disabled>é€‰æ‹©æ­¤èƒŒæ™¯å¹¶ç”Ÿæˆè§’è‰²å¡</button>
        </div>
    </div>

    <!-- æ­¥éª¤6ï¼šè§’è‰²å¡è¾“å‡º -->
    <div id="step6" class="wizard-step">
        <h2>ç¬¬å…­æ­¥ï¼šä½ çš„è§’è‰²å¡</h2>
        <p>ä»¥ä¸‹æ˜¯ä½ çš„è§’è‰²ï¼Œä¸€ä½3çº§çš„å†’é™©è€…ã€‚åŠ ç‚¹å·²ä¼˜åŒ–å¼ºåº¦ï¼Œå±æ€§å·²åŒ…å«ç§æ—è°ƒæ•´ï¼ŒåŒæ—¶åˆ—å‡ºäº†æŠ€èƒ½ç†Ÿç»ƒé¡¹ç›®ã€‚</p>
        <div id="character-sheet-output" class="output-card">
            <!-- è§’è‰²å¡å°†ç”±JSåŠ¨æ€ç”Ÿæˆ -->
        </div>
        <div class="button-container">
            <button class="btn-prev" onclick="prevStep(5)">ä¸Šä¸€æ­¥</button>
            <button class="btn-next" onclick="generateAllyOptions()">ä¸‹ä¸€æ­¥ï¼šå¯»æ‰¾ååŠ›è€…</button>
        </div>
    </div>

    <!-- æ­¥éª¤7ï¼šååŠ›è€…é€‰æ‹©ä¸æœ€ç»ˆæç¤º -->
    <div id="step7" class="wizard-step">
        <h2>ç¬¬ä¸ƒæ­¥ï¼šæ—…é€”çš„åŒä¼´</h2>
        <p>ä½ å¹¶éå­¤èº«ä¸€äººã€‚é€‰æ‹©ä¸€ä½å°†åœ¨æ—…é€”ä¸­ç›¸é‡çš„ååŠ›è€…ã€‚</p>
        <div id="ally-options-container">
            <!-- ååŠ›è€…é€‰é¡¹å°†ç”±JSåŠ¨æ€ç”Ÿæˆ -->
        </div>
        <div id="ally-sheet-output" class="output-card" style="display:none;">
            <!-- ååŠ›è€…è§’è‰²å¡å°†ç”±JSåŠ¨æ€ç”Ÿæˆ -->
        </div>
        <div class="button-container" id="ally-button-container">
            <button class="btn-prev" onclick="prevStep(6)">ä¸Šä¸€æ­¥</button>
            <button id="btn-choose-ally" class="btn-select" onclick="generateAllySheet()" disabled>é€‰æ‹©æ­¤ååŠ›è€…</button>
        </div>
        
        <div id="final-prompt-container" style="display:none;">
            <div class="final-prompt">
                <h3>ğŸ­ æ¸¸ç©å‰çš„é‡è¦æç¤º</h3>
                <p><strong>I.</strong> è¯·å°†ä¸Šæ–¹ç”Ÿæˆçš„<strong>è§’è‰²å¡</strong>å®Œæ•´å¡«å…¥è§’è‰²è®¾å®šå½“ä¸­ï¼Œå°†<strong>ååŠ›è€…è§’è‰²å¡</strong>å¡«å…¥è¡¥å……è®¾å®šå½“ä¸­ã€‚</p>
                <p><strong>II.</strong> è¿™æ˜¯ä¸€ä¸ªçœŸå®çš„ä¸–ç•Œï¼Œåœ¨åšå‡ºæŠ‰æ‹©ä¹‹å‰ï¼Œè¯·å…ˆä¸‰æ€ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶é¼“åŠ±è¿›è¡Œè§’è‰²æ‰®æ¼”ï¼Œå³æŒ‰ç…§ä½ åˆ›å»ºè§’è‰²çš„æ€§æ ¼ä¸èƒŒæ™¯è¿›è¡Œé€‰æ‹©ï¼Œä»¥è·å¾—æœ€ä½³æ¸¸æˆä½“éªŒã€‚</p>
                <p><strong>III.</strong> å°½ç®¡éš¾åº¦ä¸ä½ï¼Œä½†å°±å¦‚åŒçœŸå®ä¸–ç•Œçš„äº‹å®ä¸€æ ·ï¼Œåªè¦æ‰¾åˆ°æ­£ç¡®çš„äººä¸æ­£ç¡®çš„æ–¹æ³•ï¼Œæ€»æœ‰ä¸€çº¿ç”Ÿæœºå­˜åœ¨ã€‚é€‰æ‹©å¤§äºåŠªåŠ›ï¼ŒåŒæ—¶ï¼Œè®°å¾—çœ‹çœ‹è‡ªå·±çš„è§’è‰²ï¼Œå“ªæ€•ä½ å¾ˆèªæ˜èƒ½é€šè¿‡æ™ºæ…§è§£å†³é—®é¢˜ï¼Œä½†ä½ çš„è§’è‰²å¡æ™ºåŠ›å¤ªä½ä¹Ÿå¾ˆå¯èƒ½å¯¼è‡´åœ¨ä¸€ä¸ªä½DCæ£€å®šä¸­ä»ç„¶å¤±è´¥ã€‚é€‚åˆçš„æ‰æ˜¯æœ€å¥½çš„</p>
                <p><strong>IV.</strong> D20=20ä¹Ÿæ•‘ä¸äº†æå…¶æ„šè ¢çš„è¡Œä¸ºï¼ŒD20=1ä¹Ÿä¸ä¼šè®©æ­£ç¡®çš„åŠªåŠ›å®Œå…¨ä»˜è¯¸ä¸œæµã€‚å±æ€§æ£€å®šä¸­çš„20ä¸1éƒ½åªæ˜¯ä¸€ä¸ªæ™®é€šçš„æ•°å­—ï¼Œå¦‚æœä½ çš„è¡Œä¸ºè®©AIåˆ¤å®šDCéš¾åº¦ä¸º30ï¼Œé‚£ä¹ˆæŠ•å‡º20ä¹Ÿåªæœ‰ä½“é¢çš„å¤±è´¥ã€‚</p>
                <br>
                <p><em>ï¼ˆè¯·åœ¨ä¸‹æ–¹è¾“å…¥"ç»§ç»­"ä»¥è·å¾—åç»­æ¸¸æˆæç¤ºï¼‰</em></p>
            </div>
            <div class="button-container">
                <button class="btn-prev" onclick="showAllySelection()">ä¸Šä¸€æ­¥</button>
                <button class="btn-next" onclick="alert('è¯·å°†è§’è‰²å¡ä¸ååŠ›è€…å¡å¤åˆ¶åˆ°æ‚¨çš„æ¸¸æˆè®¾å®šä¸­ï¼Œç„¶åè¾“å…¥\'ç»§ç»­\'å¼€å§‹å†’é™©ã€‚')">å®Œæˆåˆ›å»º</button>
            </div>
        </div>
    </div>

    <footer>
        <p>é¾™ä¹‹å›½åº¦è§’è‰²åˆ›å»ºå™¨ v1.0 | åŸºäºç¬¬äº”ç‰ˆé¾™ä¸åœ°ä¸‹åŸè§„åˆ™ & ç‹¬å®¶æäºšæ›¼ç‘Ÿè®¾å®š</p>
        <p>ç”Ÿæˆå¼•æ“ï¼š<a href="#" target="_blank">å…­å·å®‡å®™ï¼ˆå®šåˆ¶ç‰ˆï¼‰</a></p>
    </footer>

    <script>
        // å…¨å±€æ•°æ®å­˜å‚¨
        const charData = {
            race: '',
            class: '',
            faith: '',
            nationality: '',
            parentStatus: '',
            adultStatus: '',
            lawAxis: '',
            goodAxis: '',
            selectedBackgroundIndex: null,
            backgroundTemplates: [],
            isSquire: false,
            selectedAlly: null,
            lifePathSummary: '' // æ–°å¢ï¼šç”¨äºå­˜å‚¨éª‘ç å¼çš„äººç”Ÿè½¨è¿¹æ–‡æœ¬
        };

        const stepElements = [1,2,3,4,5,6,7];
        let currentStep = 1;

        // æ­¥éª¤å¯¼èˆª
        function updateStepIndicator() {
            stepElements.forEach(step => {
                const dot = document.getElementById(`step${step}-dot`);
                if (step < currentStep) {
                    dot.className = 'step-dot completed';
                } else if (step === currentStep) {
                    dot.className = 'step-dot active';
                } else {
                    dot.className = 'step-dot';
                }
            });
        }

        function showStep(step) {
            stepElements.forEach(s => {
                document.getElementById(`step${s}`).classList.remove('active');
            });
            document.getElementById(`step${step}`).classList.add('active');
            currentStep = step;
            updateStepIndicator();
            window.scrollTo(0, 0);
        }

        function nextStep(step) {
            saveStepData(currentStep);
            if (currentStep === 3) {
                determineSquireStatus();
            }
            showStep(step);
        }

        function prevStep(step) {
            showStep(step);
        }

        function saveStepData(step) {
            switch(step) {
                case 1:
                    charData.race = document.getElementById('race').value;
                    charData.class = document.getElementById('class').value;
                    break;
                case 2:
                    charData.faith = document.getElementById('faith').value;
                    const nationalityRadio = document.querySelector('input[name="nationality"]:checked');
                    charData.nationality = nationalityRadio ? nationalityRadio.value : '';
                    const parentRadio = document.querySelector('input[name="parentStatus"]:checked');
                    charData.parentStatus = parentRadio ? parentRadio.value : '';
                    break;
                case 3:
                    const adultRadio = document.querySelector('input[name="adultStatus"]:checked');
                    charData.adultStatus = adultRadio ? adultRadio.value : '';
                    break;
                case 4:
                    const lawRadio = document.querySelector('input[name="lawAxis"]:checked');
                    charData.lawAxis = lawRadio ? lawRadio.value : '';
                    const goodRadio = document.querySelector('input[name="goodAxis"]:checked');
                    charData.goodAxis = goodRadio ? goodRadio.value : '';
                    break;
            }
        }

        function selectOption(cardElement, groupName) {
            const groupCards = document.querySelectorAll(`.option-card input[name="${groupName}"]`);
            groupCards.forEach(input => {
                input.parentElement.classList.remove('selected');
            });
            cardElement.classList.add('selected');
            const radio = cardElement.querySelector('input[type="radio"]');
            if (radio) radio.checked = true;
        }

        function determineSquireStatus() {
            charData.isSquire = false;
            // æ³¨æ„ï¼šHTMLä¸­adultStatusçš„å€¼é¦–å­—æ¯å¤§å†™ï¼ŒparentStatusæ˜¯å°å†™ï¼Œè¿™é‡Œåšç»Ÿä¸€å¤„ç†
            const adultStatusLower = charData.adultStatus.toLowerCase();
            const parentStatusLower = charData.parentStatus.toLowerCase();

            if (charData.nationality === 'tiamanther' && 
                (adultStatusLower === 'noble' || adultStatusLower === 'pro') && // å‡è®¾Nobleæˆ–Proéƒ½ç®—
                (parentStatusLower === 'noble' || parentStatusLower === 'burgher')) {
                charData.isSquire = true;
                console.log('éšè—èº«ä»½ï¼šåˆå§‹ä¸ºSquireï¼ˆä¾ä»éª‘å£«ï¼‰');
            }
        }

        // === æ ¸å¿ƒé€»è¾‘ä¿®æ”¹ï¼šéª‘ç å¼èƒŒæ™¯ç”Ÿæˆ ===
        function generateBackgroundOptions() {
            saveStepData(4);
            if (!charData.lawAxis || !charData.goodAxis) {
                alert('è¯·å…ˆé€‰æ‹©é˜µè¥ï¼');
                return;
            }
            nextStep(5);
            const container = document.getElementById('background-options-container');
            container.innerHTML = '';

            // 1. ç»Ÿä¸€æ•°æ®æ ¼å¼ (å…¨éƒ¨è½¬å°å†™ä»¥æ–¹ä¾¿åŒ¹é…)
            const nat = charData.nationality; // tiamanther, mulhorand, faerun
            const parent = charData.parentStatus.toLowerCase(); // poor, common, burgher, noble
            const adult = charData.adultStatus.toLowerCase(); // poor, common, burgher, noble
            const align = charData.lawAxis + charData.goodAxis; // lawfulgood, chaoticneutral, etc.
            const cls = charData.class; // fighter, wizard, etc.

            // 2. ç”Ÿæˆâ€œäººç”Ÿè½¨è¿¹â€å‰ç¼€ (Mount & Blade é£æ ¼)
            // è¿™é‡Œä½ å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹æ¯ä¸€æ®µçš„æè¿°
            let summary = "";

            // å›½ç±æè¿°
            if (nat === 'tiamanther') {
                if (parent === 'poor') summary += "ä½ çš„çˆ¶æ¯ç”Ÿæ´»åœ¨TiamantheræŸä¸€ä½è´µæ—çš„é¢†åœ°ä¹‹å†…ï¼Œä¸å¹¸çš„æ˜¯ï¼Œè¿™ä½è´µæ—å®åœ¨æ²¡ä»€ä¹ˆæ²»ç†çš„èƒ½åŠ›ã€‚ä½ çš„å®¶åº­æ•´æ—¥è¾›å‹¤å·¥ä½œå´ä»…èƒ½å¡«é¥±è‚šå­è€Œå·²ã€‚";
                else if (parent === 'common') summary += "ä½ çš„å®¶åº­æ˜¯ç”Ÿæ´»åœ¨Tiamantherçš„æ™®é€šäººï¼Œæˆ–è®¸æ˜¯åŸºå±‚å®˜åï¼Œæˆ–è®¸æ˜¯å†œæ°‘ï¼Œæ€»ä¹‹ç”Ÿæ´»å¹³æ·¡è€Œå®‰ç¨³ã€‚è™½ç„¶ä¸æ˜¯å¤§å¯Œå¤§è´µï¼Œä½†è‡³å°‘ä½ çš„ç«¥å¹´è¡£é£Ÿæ— å¿§ï¼Œä¹Ÿèƒ½æ¥å—ä¸€äº›åŸºç¡€çš„æ•™è‚²ã€‚";
                else if (parent === 'burgher') summary += "ä½ çš„çˆ¶æ¯æ˜¯Tiamantherçš„ä¸­äº§é˜¶çº§ï¼Œæˆ–è®¸æ˜¯å¤§å•†äººï¼Œæˆ–è®¸æ˜¯é«˜çº§å®˜åƒšï¼Œä¹Ÿæˆ–è®¸æ˜¯é«˜çº§æŠ€æœ¯äººå‘˜ï¼Œæ€»ä¹‹è¿‡ç€ä»¤æ™®é€šäººè‰³ç¾¡çš„ç”Ÿæ´»ã€‚ä½ çš„ç«¥å¹´é¤æ¡Œä¸Šä»ä¸ç¼ºä¹è‚‰é£Ÿï¼Œä¹Ÿæ¥å—ç€è‰¯å¥½çš„æ•™è‚²ã€‚";
                else if (parent === 'noble') summary += "ä½ çš„çˆ¶æ¯æ˜¯Tiamantherçš„å—å°éª‘å£«ï¼Œæ‹¥æœ‰è€…è‡ªå·±çš„é¢†åœ°ã€‚ä½ çš„ç«¥å¹´äº«å—ç€ä¼˜è‰¯çš„ç‰©è´¨ç”Ÿæ´»ï¼Œä¹Ÿæ¥å—ç€æœ€ä¸¥è‹›çš„æ•™è‚²ï¼Œå­¦ä¹ ç€å‡»æ€æ•Œäººçš„æŠ€å·§ä»¥åŠæ²»ç†é¢†åœ°çš„çŸ¥è¯†ã€‚";
            }
            else if (nat === 'mulhorand') {
                if (parent === 'poor') summary += "ä½ çš„çˆ¶æ¯ç”Ÿæ´»åœ¨Mulhorandçš„æœ€åº•å±‚ï¼Œé¥¥é¥¿ä¸è¿‡æ˜¯ç”Ÿæ´»ä¸­æœ€å¾®ä¸è¶³é“çš„å›°éš¾ä¹‹ä¸€ã€‚ä½ çš„ç«¥å¹´ä¸å¾—ä¸å››å¤„ä¹è®¨ï¼Œèƒ½å¤Ÿé•¿å¤§å®å±Bes(å¹¸è¿ä¹‹ç¥)çœ·é¡¾ã€‚";
                else if (parent === 'common') summary += "ä½ çš„çˆ¶æ¯æ˜¯Mulhorandçš„æ™®é€šäººã€‚ç”Ÿæ´»è™½ç„¶å›°é¡¿ï¼Œä½†è‡³å°‘ä¸ç”¨é¥¿è‚šå­ã€‚åœ¨Horus-Reçš„å…‰è¾‰ä¸‹è·å¾—å¿ƒçµçš„æ…°è—‰å’Œå…å—å¥´å½¹çš„æƒåˆ©ã€‚";
                else if (parent === 'burgher') summary += "ä½ çš„çˆ¶æ¯æˆ–è®¸æ˜¯æœåŠ¡äºMulhorandç¥æƒæœºæ„çš„åŸºå±‚å®˜åï¼Œæˆ–è®¸æ˜¯å¤§å•†äººï¼Œæ€»ä¹‹æŒæ¡ç€çŸ¥è¯†ï¼ŒæŠ€è‰ºä¸è´¢å¯Œï¼Œç”Ÿæ´»ä¼˜æ¸¥ä¸”å—äººå°Šæ•¬ã€‚";
                else if (parent === 'noble') summary += "ä½ çš„çˆ¶æ¯æ˜¯Mulhorandçš„æ•™åŒºæ€»ç®¡(Papal Vicars)ï¼ŒæŒç®¡ç€ä¸€å—è‚¥æ²ƒçš„åœŸåœ°ï¼Œä½ çš„ç«¥å¹´äº«å—ç€æœ€ä¼˜è´¨çš„ç”Ÿæ´»ã€‚";
            }
            else { // Faerun
                if (parent === 'poor') summary += "ä½ çš„çˆ¶æ¯æ˜¯æ‹¥æŒ¤åŸå¸‚ä¸­çš„ä¹ä¸æˆ–ä¹¡é‡é—´çš„ä½ƒå†œï¼Œåœ¨è¿™ä¸ªå†·æ¼ çš„ä¸–ç•Œé‡Œï¼Œè´«ç©·å°±åƒä¸€ç§æ— æ³•æ‘†è„±çš„è¯…å’’ï¼Œèƒ½å¤Ÿé•¿å¤§çº¯å±å¹¸è¿ä¹‹ç¥çš„çœ·é¡¾ã€‚";
                else if (parent === 'common') summary += "ä½ çš„å®¶åº­æ˜¯å…¸å‹çš„è´¹ä¼¦å¹³æ°‘ï¼Œç»è¥ç€ä¸€å®¶å°åº—é“ºæˆ–è€•ç§ç€å‡ äº©è–„ç”°ï¼Œç”Ÿæ´»å¹³å¹³æ·¡æ·¡ï¼Œæœ€å¤§çš„æ„¿æœ›å°±æ˜¯è¿œç¦»æ€ªç‰©çš„ä¾µæ‰°ã€‚";
                else if (parent === 'burgher') summary += "ä½ çš„çˆ¶æ¯æ˜¯å¯Œè£•çš„è¡Œä¼šå•†äººæˆ–çŸ¥åå·¥åŒ å®¶åº­ï¼Œä»æœªä½“éªŒè¿‡é¥¥é¥¿çš„æ»‹å‘³ï¼Œç«¥å¹´å……æ»¡äº†ä¹¦æœ¬ã€è‰ºæœ¯å’Œç²¾è‡´çš„é£Ÿç‰©ã€‚";
                else if (parent === 'noble') summary += "ä½ çš„çˆ¶æ¯æ˜¯æ—§å¤§é™†ä¸­çš„å°è´µæ—ï¼Œå®¶æ—çš„çº¹ç« å½°æ˜¾ç€ä½ çš„è¡€è„‰ï¼Œè‡ªå¹¼ä¾¿æ¥å—ç€ç¤¼ä»ªã€å‰‘æœ¯ä¸æ”¿æ²»çš„ç²¾è‹±æ•™è‚²ã€‚";
            }            

            // --- ç¬¬äºŒéƒ¨åˆ†ï¼šæˆå¹´ç°çŠ¶ ---
            
            // 1. Tiamanther æˆå¹´
            if (nat === 'tiamanther') {
                // ç°çŠ¶ï¼šè´«æ°‘
                if (adult === 'poor') {
                    if (parent === 'poor') summary += " å°½ç®¡ä½ æ‹¼å°½å…¨åŠ›æƒ³è¦æ‘†è„±è´«å›°ï¼Œä½†æ€»æ˜¯å·®ä¸€ç‚¹è¿æ°”ï¼Œä½ ä»ç„¶ä½äºç¤¾ä¼šçš„åº•å±‚ï¼Œä»…ä»…åªèƒ½æ··å¾—æ¸©é¥±ï¼Œç²¾æ‰“ç»†ç®—ç€æ¯ä¸€ç¬”æ”¶å…¥ã€‚";
                    else if (parent === 'noble') summary += " ç„¶è€Œï¼Œä½ ç›´åˆ°æˆå¹´æ—¢æ²¡èƒ½æˆä¸ºä¸€åæ‹¥æœ‰èŒä¸šç­‰çº§çš„è¶…å‡¡è€…ï¼Œä¹Ÿæ²¡èƒ½å­¦å¥½æ–‡åŒ–çŸ¥è¯†ï¼Œå¤±æœ›çš„çˆ¶æ¯å°†ä½ é€å‡ºå®¶é—¨ï¼Œä½ ä¸å¾—ä¸åœ¨æ³¥æ³ä¸­æŒ£æ‰ï¼Œä»¥æ¢å–ç”Ÿå­˜çš„è´¢å¯Œã€‚"; 
                    else summary += " å¯æƒœä¸€åœºçªå¦‚å…¶æ¥çš„å˜æ•…æ‰“ç ´äº†å¹³é™çš„ç”Ÿæ´»ï¼Œä½ è·Œè½è°·åº•ï¼Œä¸å¾—ä¸é‡æ–°ä½“éªŒç”Ÿå­˜çš„æ®‹é…·ã€‚";
                }
                // ç°çŠ¶ï¼šå¹³æ°‘ä¸å¸‚æ°‘
                else if (adult === 'common' || adult === 'burgher') {
                    if (parent === 'poor') summary += " ä½†ä½ æ²¡æœ‰å±ˆæœäºå‘½è¿ã€‚ä½ é€šè¿‡è‡ªå·±çš„å‹¤åŠ³ï¼ŒæˆåŠŸä»è´«æ°‘ä¸­è„±å›°ï¼Œç”¨è‡ªå·±çš„åŒæ‰‹ä¸ºè‡ªå·±æŒ£æ¥äº†ä¸€ä»½å‰ç¨‹ã€‚"; 
                    else if (parent === 'noble') summary += " ç„¶è€Œï¼Œä½ ç›´åˆ°æˆå¹´ä¹Ÿæ²¡èƒ½æˆä¸ºä¸€åæ‹¥æœ‰èŒä¸šç­‰çº§çš„è¶…å‡¡è€…ï¼Œå¥½åœ¨å­¦åˆ°äº†ä¸å°‘æ–‡åŒ–çŸ¥è¯†ã€‚ä½ çš„çˆ¶æ¯ä¸ºä½ æ‰¾äº†ä¸€ä»½æ™®é€šä½†æ¸…é—²çš„å·¥ä½œï¼Œä»¥è®©ä½ æœ‰å……è¶³çš„æ—¶é—´æ¥å—æ­¦åŠ›çš„è®­ç»ƒï¼Œå¸Œæœ›æœ‰æœä¸€æ—¥ä½ èƒ½çªç ´è‡ªæˆ‘ã€‚";
                    else summary += " æˆå¹´ä¹‹åï¼Œä½ ä¸ä½ çš„çˆ¶æ¯ä¸€æ ·å‹¤å‹‰å·¥ä½œï¼Œè¿‡ç€å®‰ç¨³ä½†å´ä¸€çœ¼å°±èƒ½æœ›åˆ°å¤´çš„ç”Ÿæ´»ã€‚";
                } // <--- ä¿®å¤ï¼šä¹‹å‰è¿™é‡Œå°‘äº†ä¸€ä¸ªå¤§æ‹¬å·
                // ç°çŠ¶ï¼šè´µæ—
                else if (adult === 'noble') {
                    if (parent === 'poor') summary += " ç„¶è€Œï¼Œä½ å¹¶æ²¡æœ‰è¢«è¿™ä»½å›°é¡¿æ‰€æ‰“è´¥ï¼Œå‹‡æ•¢çš„æŒ‘æˆ˜ç€å‘½è¿ã€‚å‡­å€Ÿç€è¿‡äººçš„å¤©èµ‹ä¸åŠªåŠ›ï¼Œä½ æˆåŠŸæˆä¸ºäº†ä¸€åè¶…å‡¡è€…ï¼Œè¢«å¸å›½æˆäºˆçˆµå£«èº«ä»½ï¼Œå‡†å¤‡ä¸ºè·å¾—å°åœ°è€Œè¿›ä¸€æ­¥åŠªåŠ›ã€‚"; 
                    else if (parent === 'noble') summary += " åæ•°å¹´å¦‚ä¸€æ—¥çš„åŠªåŠ›ç»ˆå¾—å›æŠ¥ï¼Œä½ æˆåŠŸæˆä¸ºäº†ä¸€åè¶…å‡¡è€…å¹¶è¢«å¸å›½æˆäºˆçˆµå£«èº«ä»½ã€‚æ‰¿è½½ç€å®¶æ—çš„å¸Œæœ›ï¼Œä½ å·²ç£¨å¥½åˆ€å‰‘ï¼Œé™å€™æ—¶æœºã€‚"; 
                    else summary += " ä¹‹åï¼Œä½ åœ¨å­¦é™¢ä¸­å´­éœ²å‡ºä¸è²çš„å¤©èµ‹ï¼ŒåŠ ä¹‹è¾›å‹¤çš„åŠªåŠ›ï¼Œä½ æˆåŠŸè€ƒä¸Šäº†å¸å›½å†›äº‹å¤§å­¦å¹¶æˆä¸ºäº†ä¸€åè¶…å‡¡è€…ï¼Œæ¯•ä¸šåè¢«æˆäºˆçˆµå£«èº«ä»½ï¼Œè·»èº«ç»Ÿæ²»é˜¶çº§ï¼Œå…‰è€€é—¨æ¥£ã€‚ç°åœ¨ï¼Œä½ æ­£ç­‰å¾…ç€æœºä¼šï¼Œå¸Œæœ›èƒ½æ›´è¿›ä¸€æ­¥è·å¾—å°åœ°ã€‚"; 
                }
            }
            // 2. Mulhorand æˆå¹´
            else if (nat === 'mulhorand') {
                // ç°çŠ¶ï¼šè´«æ°‘
                if (adult === 'poor'|| adult === 'common') {
                    if (parent === 'noble') summary += " ç„¶è€Œï¼Œä¸€åœºçªå¦‚å…¶æ¥çš„æ¨ªç¥¸æ‰“æ–­äº†ä½ çš„ç”Ÿæ´»ï¼Œä½ çš„çˆ¶æ¯å› ä¸ºåœ¨æ”¿æ²»æ–—äº‰ä¸­å¤±è´¥è€Œè¢«æŒ‡æ§ä¸ºå¼‚ç«¯ã€‚æ‰€å¹¸å…¬æ­£çš„æ³•å®˜å¹¶æœªå› ä½ çˆ¶æ¯çš„è¡Œä¸ºè€Œåˆ¤ä½ æœ‰ç½ªï¼Œä½†ä½ ä¹Ÿå¤±å»äº†ä¸€åˆ‡ï¼Œä¸å¾—ä¸å¼€å§‹ä½“éªŒç”Ÿæ´»çš„æ®‹é…·ã€‚";
                    else if (parent === 'burgher') summary += " ç„¶è€Œï¼Œä¸€åœºæ„å¤–æ‰“æ–­äº†ä½ çš„ç”Ÿæ´»ã€‚ä½ å¤±å»äº†ä¸€åˆ‡ï¼Œä¸å¾—ä¸å¼€å§‹ä½“éªŒç”Ÿæ´»çš„æ®‹é…·ã€‚"; 
                    else summary += " å°½ç®¡ä½ ç«­å°½å…¨åŠ›æƒ³è¦æ‘†è„±è´«å›°ï¼Œä½†å“ªæœ‰é‚£èˆ¬å®¹æ˜“ã€‚ä½ è¿˜æ˜¯åƒä½ çš„ç¥–è¾ˆä¸€æ ·ï¼Œè¢«è´«ç©·æ‰€å›°æ‰°ï¼Œåªå¾—å°†å¸Œæœ›å¯„æ‰˜äºæ¥ä¸–ã€‚";
                }
                // ç°çŠ¶ï¼šå¹³æ°‘/å¸‚æ°‘
                else if (adult === 'burgher') {
                    if (parent === 'poor'|| parent === 'common') summary += " ä½†ä½ å¹¶æ²¡æœ‰å±ˆæœäºå‘½è¿ï¼Œä½ é€šè¿‡è‡ªå·±çš„å¤©èµ‹ä¸åŠªåŠ›ï¼ŒæˆåŠŸæŒ¤å…¥ç¤¾ä¼šçš„ä¸­äº§é˜¶å±‚ï¼Œç»ˆäºå¯ä»¥ä¸ºäº†è‡ªå·±è€Œæ´»ã€‚"; // ä¿®å¤ï¼šè¿™é‡Œåº”è¯¥æ˜¯åˆ¤æ–­parent
                    else if (parent === 'noble') summary += " ç„¶è€Œä½œä¸ºå®¶æ—çš„æ¬¡å­ï¼Œä½ æ— æ³•ç»§æ‰¿çˆµä½ï¼Œä¸å¾—ä¸ç¦»å¼€å®¶æ—çš„åº‡æŠ¤ã€‚ä½ çš„å®¶æ—ç”¨è‡ªå·±çš„äººè„‰ï¼Œä¸ºä½ åœ¨ç¥æƒå®˜åƒšä½“ç³»ä¸­è°‹å¾—äº†ä¸€ä»½å·®äº‹ï¼Œå…äºæ²¦ä¸ºåº•å±‚ï¼Œä½†ä½ çš„å¿ƒä¸­éš¾å…æœ‰æ‰€é—æ†¾ã€‚";
                    else summary += " ä½ å»¶ç»­äº†å®¶æ—çš„äº‹ä¸šï¼Œåœ¨è¿™ä¸ªå¤è€çš„å›½åº¦é‡Œå®ˆä½äº†è¿™ä»½åŸºä¸šï¼Œå®‰ç¨³åº¦æ—¥ã€‚";
                }
                // ç°çŠ¶ï¼šè´µæ—
                else if (adult === 'noble') {
                    // ä¿®å¤ï¼šå­—ç¬¦ä¸²ä¸èƒ½æ¢è¡Œï¼Œä¸”é€»è¾‘åº”è¯¥æ˜¯åˆ¤æ–­parent
                    if (parent === 'poor'|| parent === 'common') summary += " å°±å½“ä½ ä»¥ä¸ºè‡ªå·±è¿™è¾ˆå­ä¹Ÿå°±è¿™æ ·çš„æ—¶å€™ï¼ŒBeså±•ç°äº†å¥¹å¯¹ä½ çš„çœ·é¡¾ã€‚ä½ è§‰é†’äº†ç¥æ€§è¡€è„‰ï¼Œè¢«å¤§ç¥­å¸è®¤å®šä¸ºç¥é€‰ä¹‹äººã€‚ä½ ä¸€æ­¥ç™»å¤©ï¼Œä»æ— äººåœ¨æ„çš„å°˜åŸƒå˜æˆäº†å—äººè†œæ‹œçš„ç¥å®˜è´µæ—ã€‚";
                    else if (parent === 'noble') summary += " ä½ ç†æ‰€å½“ç„¶åœ°ç»§æ‰¿äº†ç¥åœ£çš„èŒè´£ã€‚æ— è®ºä½ å†…å¿ƒæ˜¯å¦è™”è¯šï¼Œä½ éƒ½ç†Ÿç»ƒåœ°è¿ç”¨ç€ç¥æƒèµ‹äºˆçš„å¨ä¸¥æ¥ç»Ÿæ²»ä¸‹å±‚é˜¶çº§ã€‚";
                    else summary += " ä¹‹åï¼Œä½ å‡­å€Ÿå¯¹ç¥å­¦çš„æ·±åˆ»ç†è§£ï¼ŒæˆåŠŸè¢«ç¥æ®¿å¸çº³ï¼Œç©¿ä¸Šäº†è±¡å¾æƒåŠ›çš„ç¥­å¸é•¿è¢ï¼Œè·¨è¶Šäº†å‡¡äººä¸ç¥ä»†çš„ç•Œé™ï¼Œæˆä¸ºäº†å®¶æ—çš„éª„å‚²ã€‚";
                }
            }
            // 3. Faerun æˆå¹´
            else {
                // ç°çŠ¶ï¼šè´«æ°‘
                if (adult === 'poor') {
                    if (parent === 'noble') summary += " æ— è®ºæ˜¯å®¶æ—çš„æ²¡è½ã€æ”¿æ²»è”å§»çš„å¤±è´¥è¿˜æ˜¯ä½ ä¸ªäººçš„æ”¾è¡ä¸ç¾ï¼Œæ€»ä¹‹ä½ å¤±å»äº†ç»§æ‰¿æƒã€‚å¦‚ä»Šä½ é™¤äº†ä¸€ä¸ªé«˜è´µçš„å§“æ°ï¼Œä¸€æ— æ‰€æœ‰ã€‚";
                    else if (parent === 'common' || parent === 'burgher') summary += " å¯æƒœä¸€åœºçªå¦‚å…¶æ¥çš„ç¾éš¾æ¯æ‰äº†ä½ çš„ç”Ÿæ´»ï¼Œä½ çš„å®¶ä¹¡åœ¨æ€ªç‰©çš„è¢­å‡»ä¸‹æ²¦ä¸ºäº†åºŸå¢Ÿï¼Œä½ ä¾¥å¹¸é€ƒè„±ï¼Œä½†ä¹Ÿå¤±å»äº†ä¸€åˆ‡ã€‚"; // ä¿®å¤ï¼šè¿™é‡Œåº”è¯¥æ˜¯åˆ¤æ–­parent
                    else summary += " å°½ç®¡ä½ å‘å¾€æ›´å¥½çš„ç”Ÿæ´»ï¼Œä½†ç°å®æ˜¯æ®‹é…·çš„ã€‚ä½ ä¾ç„¶èº«æ— åˆ†æ–‡ï¼Œä¸ºäº†ä¸‹ä¸€é¡¿é¥­è€Œå››å¤„å¥”æ³¢ã€‚";
                }
                // ç°çŠ¶ï¼šå¹³æ°‘/å¸‚æ°‘
                else if (adult === 'common' || adult === 'burgher') {
                    if (parent === 'poor') summary += " ä½ ç¦»å¼€äº†è´«ç˜ çš„å®¶ä¹¡ï¼Œå­¦ä¼šäº†ä¸€é—¨æ‰‹è‰ºæˆ–åšèµ·äº†å°ä¹°å–ã€‚è™½ç„¶ä¸ç®—å¯Œè£•ï¼Œä½†ä½ å·²ç»æ¯”çˆ¶è¾ˆè¿‡å¾—å¥½å¤šäº†ã€‚";
                    else if (parent === 'noble') summary += " ç„¶è€Œä½œä¸ºå®¶æ—çš„æ¬¡å­ï¼Œä½ æ— æ³•ç»§æ‰¿çˆµä½ï¼Œä¸å¾—ä¸ç¦»å¼€å®¶æ—çš„åº‡æŠ¤ã€‚æ‰€å¹¸ä½ æ¥å—åˆ°çš„æ•™è‚²è®©ä½ ä¸è‡³äºæ²¦ä¸ºåº•å±‚ã€‚"; // ä¿®å¤ï¼šå»æ‰äº†å¤šä½™çš„å¼•å·
                    else summary += " ä½ ç»§æ‰¿äº†çˆ¶æ¯çš„å®¶ä¸šï¼Œè¿‡ç€å¹³å¹³æ·¡æ·¡çš„ç”Ÿæ´»ã€‚ç”Ÿæ´»å¹¶ä¸ç¾å¥½ï¼Œä½†å¯¹ä½ æ¥è®²è‡³å°‘è¿˜æœªå±•ç°æ®‹é…·çš„ä¸€é¢ã€‚";
                }
                // ç°çŠ¶ï¼šè´µæ—
                else if (adult === 'noble') {
                    if (parent === 'poor') summary += " å¯é‚£ä»…ä»…åªæ˜¯ä½ å¥½è¿çš„å¼€å§‹è€Œå·²ï¼Œä½ é‚£è¿‡äººçš„è¿æ°”è®©ä½ çªå‘æ¨ªè´¢ï¼Œæ— è®ºæ˜¯åœ¨é—è¿¹ä¸­æ‰¾åˆ°äº†å·¨é¢å®è—ï¼Œè¿˜æ˜¯åˆšå¥½æ¡åˆ°äº†ä¸€åå†’é™©è€…èº«ä¸Šçš„è£…å¤‡ï¼Œæ€»ä¹‹ä½ ç”¨é‡‘å¸å’Œè¿æ°”ä¸ºè‡ªå·±æ¢æ¥äº†ä¸€ä¸ªå¤´è¡”ã€‚";
                    else if (parent === 'noble') summary += " ä¹‹åï¼Œä½ æ¥è¿‡äº†å®¶æ—çš„é‡æ‹…ã€‚åœ¨æƒåŠ›çš„æ–—å…½åœºä¸­å‹¾å¿ƒæ–—è§’ï¼Œç»´æŒç€ä½“é¢çš„ç”Ÿæ´»ã€‚";
                    else summary += " é€šè¿‡ç²¾æ˜çš„å•†ä¸šè¿ä½œæˆ–å“è¶Šçš„é­”æ³•å¤©èµ‹ï¼Œä½ è·»èº«äºä¸Šæµç¤¾ä¼šï¼Œæˆä¸ºäº†å—äººå°Šæ•¬çš„æ–°è´µã€‚";
                }
            }
            
            charData.lifePathSummary = summary; 

            // 3. ç”Ÿæˆå…·ä½“çš„ä¸‰ä¸ªæ•…äº‹é€‰é¡¹
            let options = [];
            
            // ç¤ºä¾‹æƒ…å†µï¼šTiamanther + å®ˆåºå–„è‰¯ + çˆ¶æ¯è´«æ°‘ + è‡ªå·±è´µæ— + æˆ˜å£«
            if (nat === 'tiamanther' && align === 'lawfulgood' && parent === 'poor' && adult === 'noble' && cls === 'fighter') {
                options = [
                    {
                        title: "å†›åŠŸæˆçˆµ",
                        description: "ä½ åœ¨è¾¹å¢ƒæˆ˜äº‰ä¸­æ•‘ä¸‹äº†ä¸€ä½å°†å†›çš„å­å—£ã€‚å‡­å€Ÿè¿™æƒŠäººçš„æˆ˜åŠŸä¸æ­£ç›´çš„å“æ ¼ï¼Œä½ è¢«ç ´æ ¼ææ‹”å¹¶æˆäºˆçˆµä½ã€‚è™½ç„¶å‡ºèº«å‘å¾®ï¼Œä½†ä½ èª“è¨€ç”¨æ‰‹ä¸­çš„å‰‘å®ˆæŠ¤å¸å›½çš„æ³•å¾‹ä¸å¼±è€…ã€‚"
                    },
                    {
                        title: "ç«æŠ€åœºå† å†›",
                        description: "ä¸ºäº†ç»™ç”Ÿç—…çš„æ¯äº²ç­¹é’±ï¼Œä½ æŠ•èº«äºæ®‹é…·çš„è§’æ–—åœºã€‚ä½ æ‹’ç»åœ¨å¯¹æ‰‹å¤±å»åæŠ—èƒ½åŠ›åä¸‹æ€æ‰‹ï¼Œè¿™ç§éª‘å£«ç²¾ç¥èµ¢å¾—äº†è§‚ä¼—ä¸é¢†ä¸»çš„å–œçˆ±ï¼Œæœ€ç»ˆèµ¢å¾—äº†è‡ªç”±ä¸å°åœ°ã€‚"
                    },
                    {
                        title: "çš‡å®¶ä¾å«çš„é€‰æ‹”",
                        description: "åœ¨ä¸€åœºé’ˆå¯¹çš‡å®¤æˆå‘˜çš„åˆºæ€ä¸­ï¼Œå½“æ—¶è¿˜æ˜¯å«å…µçš„ä½ æŒºèº«è€Œå‡ºæŒ¡ä¸‹äº†æ¯’ç®­ã€‚ä½ çš„å¿ è¯šä¸æ— ç•è®©ä½ è¢«é€‰å…¥çš‡å®¶å«é˜Ÿï¼Œä»æ­¤è„±ç¦»äº†è´«æ°‘çªŸçš„æ³¥æ½­ã€‚"
                    }
                ];
            }
            // ç¤ºä¾‹æƒ…å†µ2ï¼šMulhorand + æ··ä¹±ä¸­ç«‹ + çˆ¶æ¯è´µæ— + è‡ªå·±è´«æ°‘ + æ¸¸è¡è€…
            else if (nat === 'mulhorand' && align === 'chaoticneutral' && parent === 'noble' && adult === 'poor' && cls === 'rogue') {
                options = [
                    {
                        title: "å®¶æ—çš„å›é€†è€…",
                        description: "ä½ åŒå€¦äº†ç¥æƒæ”¿æ²»ä¸‹è™šä¼ªçš„è´µæ—ç”Ÿæ´»ï¼Œåœ¨ä¸€ä¸ªé›¨å¤œå·èµ°äº†å®¶æ—çš„å°ç« ç¦»å®¶å‡ºèµ°ã€‚å¦‚ä»Šä½ åœ¨ä¸‹æ°´é“ä¸é»‘å¸‚ä¸­å¦‚é±¼å¾—æ°´ï¼Œè™½ç„¶è´«ç©·ï¼Œä½†ä½ æ‹¥æœ‰äº†æ¸´æœ›çš„è‡ªç”±ã€‚"
                    },
                    {
                        title: "æ”¿æ²»æ–—äº‰çš„ç‰ºç‰²å“",
                        description: "ä½ çš„å®¶æ—åœ¨ç¥æ®¿çš„æƒåŠ›æ–—äº‰ä¸­è½è´¥ï¼Œå…¨æ—è¢«æµæ”¾ã€‚ä½ ä¾¥å¹¸é€ƒè„±ï¼Œéšå§“åŸ‹åã€‚æ›¾ç»çš„é”¦è¡£ç‰é£ŸåŒ–ä¸ºæ³¡å½±ï¼Œç°åœ¨ä½ åªä¿¡å¥‰æ‰‹ä¸­çš„åŒ•é¦–å’Œé‡‘å¸ã€‚"
                    },
                    {
                        title: "è¢«è¯…å’’çš„è¡€è„‰",
                        description: "ä½ å‡ºç”Ÿæ—¶å¸¦æœ‰æŸç§è¢«è§†ä¸ºä¸ç¥¥çš„å°è®°ï¼Œè¢«å®¶æ—é—å¼ƒåœ¨è´«æ°‘çªŸã€‚ä½ åœ¨è¡—å¤´å­¦ä¼šäº†å·çªƒä¸æ¬ºè¯ˆï¼Œå¯¹æ‰€è°“çš„è´µæ—è¡€ç»Ÿå—¤ä¹‹ä»¥é¼»ã€‚"
                    }
                ];
            }
            // === é»˜è®¤å…œåº•é€‰é¡¹ ===
            else {
                options = [
                    {
                        title: "å‘½è¿çš„è½¬æŠ˜ç‚¹ (é€šç”¨)",
                        description: "ä¸€ä¸ªå¶ç„¶çš„æœºä¼šæ”¹å˜äº†ä½ çš„äººç”Ÿè½¨è¿¹ã€‚ä¹Ÿè®¸æ˜¯ä¸€æ¬¡æ„å¤–çš„å‘ç°ï¼Œä¹Ÿè®¸æ˜¯ä¸€æ¬¡ç”Ÿç¦»æ­»åˆ«ï¼Œè®©ä½ èµ°ä¸Šäº†å†’é™©è€…çš„é“è·¯ã€‚"
                    },
                    {
                        title: "æ‰§ç€çš„è¿½æ±‚ (é€šç”¨)",
                        description: "ä½ å¿ƒä¸­æœ‰ä¸€ä¸ªæ— æ³•æ”¾ä¸‹çš„æ‰§å¿µã€‚æ— è®ºæ˜¯å¤ä»‡ã€å¯»å®è¿˜æ˜¯å¯»æ‰¾å¤±æ•£çš„äº²äººï¼Œè¿™ä¸ªç›®æ ‡é©±ä½¿ä½ ç¦»å¼€äº†åŸæœ¬çš„ç”Ÿæ´»ã€‚"
                    },
                    {
                        title: "è¢«è¿«çš„æµäº¡ (é€šç”¨)",
                        description: "æˆ˜äº‰æˆ–ç¾éš¾æ‘§æ¯äº†ä½ çš„å®¶å›­ã€‚ä½ è¢«è¿«èƒŒäº•ç¦»ä¹¡ï¼Œåœ¨æäºšæ›¼ç‘Ÿè¿™ç‰‡é™Œç”Ÿçš„åœŸåœ°ä¸Šå¯»æ‰¾æ–°çš„ç«‹è¶³ä¹‹åœ°ã€‚"
                    }
                ];
            }

            charData.backgroundTemplates = options;

            // æ¸²æŸ“é€‰é¡¹å¡
            charData.backgroundTemplates.forEach((bg, index) => {
                const bgCard = document.createElement('div');
                bgCard.className = 'option-card';
                bgCard.innerHTML = `
                    <input type="radio" id="bg${index}" name="bgChoice" value="${index}">
                    <label for="bg${index}"><strong>é€‰é¡¹ ${index + 1}: ${bg.title}</strong></label>
                    <div class="desc">${bg.description}</div>
                `;
                bgCard.onclick = () => {
                    selectOption(bgCard, 'bgChoice');
                    document.getElementById('btn-choose-bg').disabled = false;
                    charData.selectedBackgroundIndex = index;
                };
                container.appendChild(bgCard);
            });
        }
        // ç”Ÿæˆæœ€ç»ˆè§’è‰²å¡
        function generateCharacterSheet() {
            nextStep(6); 
            
            const raceNames = {
                human: 'äººç±»', dragonborn: 'é¾™è£”', kobold: 'ç‹—å¤´äºº', 
                'half-orc': 'åŠå…½äºº', lizardfolk: 'èœ¥èœ´äºº', 
                elf: 'ç²¾çµ', dwarf: 'çŸ®äºº', other: 'å¼‚æ—'
            };
            const classNames = {
                fighter: 'æˆ˜å£«', paladin: 'åœ£æ­¦å£«', ranger: 'æ¸¸ä¾ ', 
                rogue: 'æ¸¸è¡è€…', wizard: 'æ³•å¸ˆ', cleric: 'ç‰§å¸ˆ', druid: 'å¾·é²ä¼Š', bard: 'åŸæ¸¸è¯—äºº', 
                barbarian: 'é‡è›®äºº', monk: 'æ­¦åƒ§', sorcerer: 'æœ¯å£«', warlock: 'é‚ªæœ¯å¸ˆ'
            };
            const lawText = { lawful: 'å®ˆåº', neutral: 'ä¸­ç«‹', chaotic: 'æ··ä¹±' };
            const goodText = { good: 'å–„è‰¯', neutral: 'ä¸­ç«‹', evil: 'é‚ªæ¶' };

            const alignment = `${lawText[charData.lawAxis] || ''}${goodText[charData.goodAxis] || ''}`;
            
            const selectedBg = charData.backgroundTemplates[charData.selectedBackgroundIndex];
            const abilityMod = (score) => Math.floor((score - 10) / 2);
            const formatMod = (score) => {
                const mod = abilityMod(score);
                return mod >= 0 ? `+${mod}` : `${mod}`;
            };

            // å±æ€§ä¸æŠ€èƒ½é€»è¾‘
            let abilities = { 'åŠ›é‡': 16, 'æ•æ·': 15, 'ä½“è´¨': 15, 'æ™ºåŠ›': 10, 'æ„ŸçŸ¥': 10, 'é­…åŠ›': 8 };
            let skillsText = "å¯Ÿè§‰, è¿åŠ¨";
            
            if (['fighter', 'barbarian'].includes(charData.class)) {
                abilities = { 'åŠ›é‡':17, 'æ•æ·':15, 'ä½“è´¨':17, 'æ™ºåŠ›':8, 'æ„ŸçŸ¥':10, 'é­…åŠ›':10 };
                skillsText = "è¿åŠ¨, å¨å“, æ±‚ç”Ÿ"
            } else if (['wizard'].includes(charData.class)) {
                abilities = { 'åŠ›é‡':8, 'æ•æ·':15, 'ä½“è´¨':17, 'æ™ºåŠ›':17, 'æ„ŸçŸ¥':10, 'é­…åŠ›':10 };
                skillsText = "å¥¥ç§˜, å†å², è°ƒæŸ¥"
            } else if (['cleric'].includes(charData.class)) {
                 abilities = { 'åŠ›é‡':17, 'æ•æ·':10, 'ä½“è´¨':15, 'æ™ºåŠ›':8, 'æ„ŸçŸ¥':17, 'é­…åŠ›':10 };
                 skillsText = "æ´æ‚‰, å®—æ•™, åŒ»ç–—"
            } else if (['sorcerer'].includes(charData.class)) {
                 abilities = { 'åŠ›é‡':8, 'æ•æ·':17, 'ä½“è´¨':15, 'æ™ºåŠ›':10, 'æ„ŸçŸ¥':10, 'é­…åŠ›':17 };
                 skillsText = "æ¬ºç’, è¯´æœ, å¥¥ç§˜"
            } else if (['warlock', 'bard'].includes(charData.class)) {
                 abilities = { 'åŠ›é‡':8, 'æ•æ·':15, 'ä½“è´¨':17, 'æ™ºåŠ›':10, 'æ„ŸçŸ¥':10, 'é­…åŠ›':17 };
                 skillsText = "è¯´æœ, å¨å“, æ¬ºç’"
            } else if (['druid'].includes(charData.class)) {
                 abilities = { 'åŠ›é‡':8, 'æ•æ·':15, 'ä½“è´¨':17, 'æ™ºåŠ›':10, 'æ„ŸçŸ¥':17, 'é­…åŠ›':10 };
                 skillsText = "å¯Ÿè§‰, å­˜æ´», è‡ªç„¶"
            } else if ([ 'paladin'].includes(charData.class)) {
                 abilities = { 'åŠ›é‡':17, 'æ•æ·':8, 'ä½“è´¨':15, 'æ™ºåŠ›':10, 'æ„ŸçŸ¥':10, 'é­…åŠ›':17 };
                 skillsText = "è¯´æœ, è¿åŠ¨, æ´æ‚‰"
            } else if (['rogue', 'ranger', 'monk'].includes(charData.class)) {
                abilities = { 'åŠ›é‡':8, 'æ•æ·':17, 'ä½“è´¨':15, 'æ™ºåŠ›':10, 'æ„ŸçŸ¥':17, 'é­…åŠ›':10 };
                 skillsText = "éšåŒ¿, å¯Ÿè§‰, ä½“æ“"
            }

            // ç”Ÿå‘½å€¼è®¡ç®—
            const hdMap = {
                'barbarian': 12,
                'fighter': 10, 'paladin': 10, 'ranger': 10,
                'wizard': 6, 'sorcerer': 6,
                'cleric': 8, 'druid': 8, 'monk': 8, 'rogue': 8, 'warlock': 8, 'bard': 8
            };
            const die = hdMap[charData.class] || 8;
            const cMod = abilityMod(abilities['ä½“è´¨']);
            const totalHP = die + (Math.floor(die / 2) + 1) * 2 + (cMod * 3);

            let equipment = 'æ¢é™©è€…å¥—è£…ï¼ŒèŒä¸šèµ·å§‹æ­¦å™¨ï¼Œæ™®é€šæ—…è¡Œè¡£ç‰©ï¼Œ50gp';
            if (charData.isSquire) {
                equipment = 'ã€Squireç‰¹æƒã€‘é“¶é•€å•æ‰‹çŸ›ï¼Œé•¿å‰‘ï¼Œç›¾ç‰Œï¼Œéª‘æªä¸€æ”¯ï¼Œæ¿ç”²/+1çš®ç”²/+1å¸ƒç”²(è‡ªå·±é€‰ä¸€ä¸ª)ï¼Œäº”æ”¯æ ‡æªï¼Œæ¿ç”²æˆ˜é©¬ä¸€åŒ¹720gp';
            }

            const sheet = `=== è§’è‰²å¡ ===
å§“åï¼š [è¯·åœ¨æ­¤è¾“å…¥è§’è‰²å]
ç§æ—ï¼š ${raceNames[charData.race] || charData.race}
èŒä¸šï¼š ${classNames[charData.class] || charData.class} 3çº§
èƒŒæ™¯ï¼š ${selectedBg.title}
é˜µè¥ï¼š ${alignment}
ä¿¡ä»°ï¼š ${charData.faith ? (charData.faith === 'tiamat' ? 'æäºšç›ç‰¹ (å¸å›½å›½æ•™)' : charData.faith) : 'æ— æˆ–è‡ªå®šä¹‰'}
æŠ€èƒ½ç†Ÿç»ƒé¡¹ï¼š ${skillsText}

--- å±æ€§ (å·²å«ç§æ—è°ƒæ•´) ---
åŠ›é‡ï¼š ${abilities['åŠ›é‡']} (${formatMod(abilities['åŠ›é‡'])})
æ•æ·ï¼š ${abilities['æ•æ·']} (${formatMod(abilities['æ•æ·'])})
ä½“è´¨ï¼š ${abilities['ä½“è´¨']} (${formatMod(abilities['ä½“è´¨'])})
æ™ºåŠ›ï¼š ${abilities['æ™ºåŠ›']} (${formatMod(abilities['æ™ºåŠ›'])})
æ„ŸçŸ¥ï¼š ${abilities['æ„ŸçŸ¥']} (${formatMod(abilities['æ„ŸçŸ¥'])})
é­…åŠ›ï¼š ${abilities['é­…åŠ›']} (${formatMod(abilities['é­…åŠ›'])})

--- æˆ˜æ–—æ•°æ® ---
ç”Ÿå‘½å€¼ï¼š ${totalHP} (é¢„ä¼°å€¼)
æŠ¤ç”²ç­‰çº§ï¼š ${10 + abilityMod(abilities['æ•æ·'])} (åŸºç¡€ï¼Œè¯·åŠ ä¸ŠæŠ¤ç”²å€¼)
å…ˆæ”»ï¼š ${formatMod(abilities['æ•æ·'])}
ç†Ÿç»ƒåŠ å€¼ï¼š +2

--- è£…å¤‡ ---
${equipment}

--- èƒŒæ™¯æ•…äº‹ ---
ã€äººç”Ÿè½¨è¿¹ã€‘
${charData.lifePathSummary}

ã€å…³é”®è½¬æŠ˜ã€‘
${selectedBg.description}

--- ç‰¹æ®Šå¤‡æ³¨ ---
${charData.isSquire ? 'ã€éšè—ä¿¡æ¯ï¼šåˆå§‹èº«ä»½ä¸ºSquireï¼ˆä¾ä»éª‘å£«ï¼‰ï¼Œäº«æœ‰å¸å›½æä¾›çš„é£Ÿå®¿åŠ720é‡‘å¸å¹´è–ªã€‚æ­¤ä¿¡æ¯ä»…DMçŸ¥æ™“ã€‚ã€‘' : 'æ— '}
            `;

            document.getElementById('character-sheet-output').textContent = sheet;
        }

        function generateAllyOptions() {
            nextStep(7);
            const container = document.getElementById('ally-options-container');
            container.innerHTML = '';

            const allyOptions = [
                {
                    title: 'â€œç°çƒ¬â€è‰¾æ‹‰',
                    desc: 'ä¸€ä½æ²‰é»˜å¯¡è¨€çš„é¾™è£”æ¸¸ä¾ ï¼Œæ¥è‡ªè¢«æˆ˜ç«æ‘§æ¯çš„è¾¹å¢ƒæ‘è½ã€‚'
                },
                {
                    title: 'â€œé“ç §â€å·´å°”å¤š',
                    desc: 'çŸ®äººç‰§å¸ˆï¼Œå¸å›½å›½è¥ä¼ä¸šçš„èµ„æ·±é“åŒ ï¼Œæ­£æŠ¤é€é‡è¦ç‰©èµ„ã€‚'
                },
                {
                    title: 'â€œå½±èˆâ€è‰äºšæ‹‰',
                    desc: 'åŠç²¾çµæ¸¸è¡è€…ï¼Œè‡ªç§°æ˜¯å®è—çŒäººï¼Œå¯¹é¾™æ—ç§˜å®ææ„Ÿå…´è¶£ã€‚'
                },
                {
                    title: 'â€œå­¦è€…â€å¡é‡Œå§†',
                    desc: 'äººç±»æ³•å¸ˆï¼Œæ­£åœ¨ç ”ç©¶ä¸œéƒ¨è¾¹å¢ƒå¼‚å¸¸çš„åœ°è„‰èƒ½é‡æ³¢åŠ¨ã€‚'
                }
            ];

            allyOptions.forEach((ally, index) => {
                const allyCard = document.createElement('div');
                allyCard.className = 'option-card';
                allyCard.innerHTML = `
                    <input type="radio" id="ally${index}" name="allyChoice" value="${index}">
                    <label for="ally${index}"><strong>${ally.title}</strong></label>
                    <div class="desc">${ally.desc}</div>
                `;
                allyCard.onclick = () => {
                    selectOption(allyCard, 'allyChoice');
                    document.getElementById('btn-choose-ally').disabled = false;
                    charData.selectedAlly = index;
                };
                container.appendChild(allyCard);
            });
        }

        function generateAllySheet() {
            if (charData.selectedAlly === null) return;

            const allyData = [
                { 
                    name:'â€œç°çƒ¬â€è‰¾æ‹‰', 
                    race:'é¾™è£”', 
                    class:'æ¸¸ä¾ ', 
                    level:3, 
                    alignment:'ä¸­ç«‹å–„è‰¯', 
                    str:15, dex:17, con:14, int:10, wis:16, cha:8, 
                    background:'è¾¹å¢ƒå¹¸å­˜è€…',
                    desc:'ä¸€ä½æ²‰é»˜å¯¡è¨€çš„é¾™è£”æ¸¸ä¾ ï¼Œæ¥è‡ªè¢«æˆ˜ç«æ‘§æ¯çš„è¾¹å¢ƒæ‘è½ã€‚å¥¹è¿½è¸ªç€ä¸€æ”¯è¢­å‡»å•†é˜Ÿçš„æ€ªç‰©ç¾¤ï¼Œå£°ç§°å…¶ä¸­æ··å…¥äº†"æ›´å±é™©çš„ä¸œè¥¿"ã€‚'
                },
                { 
                    name:'â€œé“ç §â€å·´å°”å¤š', 
                    race:'çŸ®äºº', 
                    class:'ç‰§å¸ˆ', 
                    level:3, 
                    alignment:'å®ˆåºå–„è‰¯', 
                    str:16, dex:10, con:17, int:12, wis:17, cha:8, 
                    background:'å¸å›½é“åŒ ',
                    desc:'çŸ®äººç‰§å¸ˆï¼Œä¿¡ä»°æ‘©æ‹‰ä¸ã€‚ä»–æ˜¯å¸å›½å›½è¥å„æ–­ä¼ä¸šçš„ä¸€åèµ„æ·±é“åŒ ï¼Œå¥‰å‘½æŠ¤é€ä¸€æ‰¹ç‰¹æ®Šç‰©èµ„å‰å¾€å‰çº¿ï¼Œä½†è¿è¾“é˜Ÿé­åˆ°äº†ä¼å‡»ã€‚'
                },
                { 
                    name:'â€œå½±èˆâ€è‰äºšæ‹‰', 
                    race:'åŠç²¾çµ', 
                    class:'æ¸¸è¡è€…', 
                    level:3, 
                    alignment:'æ··ä¹±ä¸­ç«‹', 
                    str:8, dex:18, con:14, int:14, wis:10, cha:16, 
                    background:'å®è—çŒäºº',
                    desc:'åŠç²¾çµæ¸¸è¡è€…ï¼Œè‡ªç§°æ˜¯æ¥è‡ªæ·±æ°´åŸçš„å®è—çŒäººã€‚å¥¹å¯¹æäºšæ›¼ç‘Ÿçš„å¤ä»£é—è¿¹ï¼Œå°¤å…¶æ˜¯é¾™æ—ç›¸å…³çš„ç§˜å®æœ‰ç€å¼‚ä¹å¯»å¸¸çš„å…´è¶£ã€‚'
                },
                { 
                    name:'â€œå­¦è€…â€å¡é‡Œå§†', 
                    race:'äººç±»', 
                    class:'æ³•å¸ˆ', 
                    level:3, 
                    alignment:'å®ˆåºä¸­ç«‹', 
                    str:8, dex:14, con:13, int:18, wis:16, cha:10, 
                    background:'å¸å›½å­¦è€…',
                    desc:'äººç±»æ³•å¸ˆï¼Œå›½å®¶å¤§å­¦çš„æ¯•ä¸šç”Ÿã€‚ä»–æ­£åœ¨ç ”ç©¶ä¸œéƒ¨è¾¹å¢ƒå¼‚å¸¸çš„åœ°è„‰èƒ½é‡æ³¢åŠ¨ï¼Œæ‹…å¿ƒè¿™ä¸å¸å›½æˆ–æ•Œæ–¹çš„æŸç§å¤§è§„æ¨¡ä»ªå¼æœ‰å…³ã€‚'
                }
            ];

            const ally = allyData[charData.selectedAlly];
            const abilityMod = (score) => Math.floor((score - 10) / 2);

            const sheet = `=== ååŠ›è€…è§’è‰²å¡ ===
å§“åï¼š ${ally.name}
ç§æ—ï¼š ${ally.race}
èŒä¸šï¼š ${ally.class} ${ally.level}çº§
é˜µè¥ï¼š ${ally.alignment}
èƒŒæ™¯ï¼š ${ally.background}

--- å±æ€§ ---
åŠ›é‡ï¼š ${ally.str} (${abilityMod(ally.str)})
æ•æ·ï¼š ${ally.dex} (${abilityMod(ally.dex)})
ä½“è´¨ï¼š ${ally.con} (${abilityMod(ally.con)})
æ™ºåŠ›ï¼š ${ally.int} (${abilityMod(ally.int)})
æ„ŸçŸ¥ï¼š ${ally.wis} (${abilityMod(ally.wis)})
é­…åŠ›ï¼š ${ally.cha} (${abilityMod(ally.cha)})

--- ç®€è¦èƒŒæ™¯ ---
${ally.desc}

--- ä¸ç©å®¶çš„å…³ç³» ---
ä¸ä½ çš„è§’è‰²æš‚æ— äº¤é›†ï¼Œå°†åœ¨æ¸¸æˆè¿›ç¨‹ä¸­å› ç‰¹å®šäº‹ä»¶ç›¸é‡ã€‚å¯ä½œä¸ºä¸´æ—¶ç›Ÿå‹ã€ä¿¡æ¯æä¾›è€…æˆ–ä»»åŠ¡å§”æ‰˜äººã€‚`;

            const outputDiv = document.getElementById('ally-sheet-output');
            outputDiv.textContent = sheet;
            outputDiv.style.display = 'block';

            document.getElementById('ally-button-container').style.display = 'none';
            document.getElementById('final-prompt-container').style.display = 'block';
        }

        function showAllySelection() {
            document.getElementById('ally-sheet-output').style.display = 'none';
            document.getElementById('final-prompt-container').style.display = 'none';
            document.getElementById('ally-button-container').style.display = 'flex';
        }

        // åˆå§‹åŒ–
        window.onload = function() {
            updateStepIndicator();
            // ä¸ºæ­¥éª¤1æ·»åŠ äº‹ä»¶ç›‘å¬
            document.getElementById('race').addEventListener('change', function() {
                charData.race = this.value;
            });
            document.getElementById('class').addEventListener('change', function() {
                charData.class = this.value;
            });
            document.getElementById('faith').addEventListener('change', function() {
                charData.faith = this.value;
            });
        };
    </script>
</body>
</html>

